<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: Mempak Filesystem Routines</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Mempak Filesystem Routines<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__controller.html">Controller Subsystem</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Managed mempak interface.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:mempak_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mempak_8c.html">mempak.c</a></td></tr>
<tr class="memdesc:mempak_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mempak Filesystem Routine. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:mempak_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mempak_8h.html">mempak.h</a></td></tr>
<tr class="memdesc:mempak_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mempak Filesystem Routines. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structentry__structure__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a></td></tr>
<tr class="memdesc:structentry__structure__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing a save entry in a mempak.  <a href="group__mempak.html#structentry__structure__t">More...</a><br /></td></tr>
<tr class="separator:structentry__structure__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga8291313350e93f54e8c397f6d13f9454"><td class="memItemLeft" align="right" valign="top"><a id="ga8291313350e93f54e8c397f6d13f9454" name="ga8291313350e93f54e8c397f6d13f9454"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MEMPAK_BLOCK_SIZE</b>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ga8291313350e93f54e8c397f6d13f9454"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size in bytes of a Mempak block. <br /></td></tr>
<tr class="separator:ga8291313350e93f54e8c397f6d13f9454"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3811bed7584fee9426fa21cb77c6d669"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#ga3811bed7584fee9426fa21cb77c6d669">read_mempak_sector</a> (int controller, int sector, uint8_t *sector_data)</td></tr>
<tr class="memdesc:ga3811bed7584fee9426fa21cb77c6d669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a sector from a mempak.  <a href="group__mempak.html#ga3811bed7584fee9426fa21cb77c6d669">More...</a><br /></td></tr>
<tr class="separator:ga3811bed7584fee9426fa21cb77c6d669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb6424e211071cbb4fa7990fca01b96c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#gacb6424e211071cbb4fa7990fca01b96c">write_mempak_sector</a> (int controller, int sector, uint8_t *sector_data)</td></tr>
<tr class="memdesc:gacb6424e211071cbb4fa7990fca01b96c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a sector to a mempak.  <a href="group__mempak.html#gacb6424e211071cbb4fa7990fca01b96c">More...</a><br /></td></tr>
<tr class="separator:gacb6424e211071cbb4fa7990fca01b96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf245021aed55de7a17cf417d41cdc32f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#gaf245021aed55de7a17cf417d41cdc32f">validate_mempak</a> (int controller)</td></tr>
<tr class="memdesc:gaf245021aed55de7a17cf417d41cdc32f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return whether a mempak is valid.  <a href="group__mempak.html#gaf245021aed55de7a17cf417d41cdc32f">More...</a><br /></td></tr>
<tr class="separator:gaf245021aed55de7a17cf417d41cdc32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa54d6b5cea4be11738f951318ebc758"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#gaaa54d6b5cea4be11738f951318ebc758">get_mempak_entry</a> (int controller, int entry, <a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *entry_data)</td></tr>
<tr class="memdesc:gaaa54d6b5cea4be11738f951318ebc758"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read an entry on a mempak.  <a href="group__mempak.html#gaaa54d6b5cea4be11738f951318ebc758">More...</a><br /></td></tr>
<tr class="separator:gaaa54d6b5cea4be11738f951318ebc758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b092c36dbd886af01b0c4be86554946"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#ga5b092c36dbd886af01b0c4be86554946">get_mempak_free_space</a> (int controller)</td></tr>
<tr class="memdesc:ga5b092c36dbd886af01b0c4be86554946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of free blocks on a mempak.  <a href="group__mempak.html#ga5b092c36dbd886af01b0c4be86554946">More...</a><br /></td></tr>
<tr class="separator:ga5b092c36dbd886af01b0c4be86554946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14df2d1b0aeb7436cabd95294eb29b9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#ga14df2d1b0aeb7436cabd95294eb29b9f">format_mempak</a> (int controller)</td></tr>
<tr class="memdesc:ga14df2d1b0aeb7436cabd95294eb29b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a mempak.  <a href="group__mempak.html#ga14df2d1b0aeb7436cabd95294eb29b9f">More...</a><br /></td></tr>
<tr class="separator:ga14df2d1b0aeb7436cabd95294eb29b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e07b0ab92a7f383b355f5ed99c5f727"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#ga7e07b0ab92a7f383b355f5ed99c5f727">read_mempak_entry_data</a> (int controller, <a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *entry, uint8_t *data)</td></tr>
<tr class="memdesc:ga7e07b0ab92a7f383b355f5ed99c5f727"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the data associated with an entry on a mempak.  <a href="group__mempak.html#ga7e07b0ab92a7f383b355f5ed99c5f727">More...</a><br /></td></tr>
<tr class="separator:ga7e07b0ab92a7f383b355f5ed99c5f727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga520a9d2a4eb81c7f40ed2fcc9ecafecc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#ga520a9d2a4eb81c7f40ed2fcc9ecafecc">write_mempak_entry_data</a> (int controller, <a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *entry, uint8_t *data)</td></tr>
<tr class="memdesc:ga520a9d2a4eb81c7f40ed2fcc9ecafecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write associated data to a mempak entry.  <a href="group__mempak.html#ga520a9d2a4eb81c7f40ed2fcc9ecafecc">More...</a><br /></td></tr>
<tr class="separator:ga520a9d2a4eb81c7f40ed2fcc9ecafecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa56a78fe3d1d2b9427afe8d5894156df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mempak.html#gaa56a78fe3d1d2b9427afe8d5894156df">delete_mempak_entry</a> (int controller, <a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *entry)</td></tr>
<tr class="memdesc:gaa56a78fe3d1d2b9427afe8d5894156df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a mempak entry and associated data.  <a href="group__mempak.html#gaa56a78fe3d1d2b9427afe8d5894156df">More...</a><br /></td></tr>
<tr class="separator:gaa56a78fe3d1d2b9427afe8d5894156df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Inode values</h2></td></tr>
<tr class="memitem:ga4642580b046949b340ed1663c65fc226"><td class="memItemLeft" align="right" valign="top"><a id="ga4642580b046949b340ed1663c65fc226" name="ga4642580b046949b340ed1663c65fc226"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BLOCK_EMPTY</b>&#160;&#160;&#160;0x03</td></tr>
<tr class="memdesc:ga4642580b046949b340ed1663c65fc226"><td class="mdescLeft">&#160;</td><td class="mdescRight">This block is empty. <br /></td></tr>
<tr class="separator:ga4642580b046949b340ed1663c65fc226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf535f6a89db6d7c4b2c54e98f43facb"><td class="memItemLeft" align="right" valign="top"><a id="gaaf535f6a89db6d7c4b2c54e98f43facb" name="gaaf535f6a89db6d7c4b2c54e98f43facb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BLOCK_LAST</b>&#160;&#160;&#160;0x01</td></tr>
<tr class="memdesc:gaaf535f6a89db6d7c4b2c54e98f43facb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the last block in the note. <br /></td></tr>
<tr class="separator:gaaf535f6a89db6d7c4b2c54e98f43facb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42c87752b22ef217fa258ead71a46318"><td class="memItemLeft" align="right" valign="top"><a id="ga42c87752b22ef217fa258ead71a46318" name="ga42c87752b22ef217fa258ead71a46318"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BLOCK_VALID_FIRST</b>&#160;&#160;&#160;0x05</td></tr>
<tr class="memdesc:ga42c87752b22ef217fa258ead71a46318"><td class="mdescLeft">&#160;</td><td class="mdescRight">First valid block that can contain user data. <br /></td></tr>
<tr class="separator:ga42c87752b22ef217fa258ead71a46318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga669cc689e0f884dbf9ddd0a20cd799c5"><td class="memItemLeft" align="right" valign="top"><a id="ga669cc689e0f884dbf9ddd0a20cd799c5" name="ga669cc689e0f884dbf9ddd0a20cd799c5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BLOCK_VALID_LAST</b>&#160;&#160;&#160;0x7F</td></tr>
<tr class="memdesc:ga669cc689e0f884dbf9ddd0a20cd799c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last valid block that can contain user data. <br /></td></tr>
<tr class="separator:ga669cc689e0f884dbf9ddd0a20cd799c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >Managed mempak interface. </p>
<p >The mempak system is a subsystem of the <a class="el" href="group__controller.html">Controller Subsystem</a>. Before attempting to read from or write to a mempak, be sure you have initialized the controller system with <a class="el" href="group__controller.html#gad13ec5f696a3c69997b9fc57246a0238" title="Initialize the controller subsystem.">controller_init</a> and verified that you have a mempak in the correct controller using <a class="el" href="group__controller.html#ga61f79691c93aed5a6abaf2d962823680" title="Identify the accessory connected to a controller.">identify_accessory</a>.</p>
<p >To read and write to the mempak in an organized way compatible with official software, first check that the mempak is valid using <a class="el" href="group__mempak.html#gaf245021aed55de7a17cf417d41cdc32f" title="Return whether a mempak is valid.">validate_mempak</a>. If the mempack is invalid, it will need to be formatted using <a class="el" href="group__mempak.html#ga14df2d1b0aeb7436cabd95294eb29b9f" title="Format a mempak.">format_mempak</a>. Once the mempak is considered valid, existing notes can be enumerated using <a class="el" href="group__mempak.html#gaaa54d6b5cea4be11738f951318ebc758" title="Read an entry on a mempak.">get_mempak_entry</a>. To read the data associated with a note, use <a class="el" href="group__mempak.html#ga7e07b0ab92a7f383b355f5ed99c5f727" title="Read the data associated with an entry on a mempak.">read_mempak_entry_data</a>. To write a new note to the mempak, use <a class="el" href="group__mempak.html#ga520a9d2a4eb81c7f40ed2fcc9ecafecc" title="Write associated data to a mempak entry.">write_mempak_entry_data</a>. Note that there is no append functionality so if a note is being updated, ensure you have deleted the old note first using <a class="el" href="group__mempak.html#gaa56a78fe3d1d2b9427afe8d5894156df" title="Delete a mempak entry and associated data.">delete_mempak_entry</a>. Code should be careful to check how many blocks are free before writing using <a class="el" href="group__mempak.html#ga5b092c36dbd886af01b0c4be86554946" title="Return the number of free blocks on a mempak.">get_mempak_free_space</a>. </p>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structentry__structure__t" id="structentry__structure__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structentry__structure__t">&#9670;&nbsp;</a></span>entry_structure_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct entry_structure_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p >Structure representing a save entry in a mempak. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a93cca58c3728111ce6c8b925009afa83" name="a93cca58c3728111ce6c8b925009afa83"></a>uint8_t</td>
<td class="fieldname">
blocks</td>
<td class="fielddoc">
Number of blocks used by this entry. <dl class="section see"><dt>See also</dt><dd><a class="el" href="group__mempak.html#ga8291313350e93f54e8c397f6d13f9454" title="Size in bytes of a Mempak block.">MEMPAK_BLOCK_SIZE</a> </dd></dl>
</td></tr>
<tr><td class="fieldtype">
<a id="ad6124aefb1425f190a3665f7a0c3aefc" name="ad6124aefb1425f190a3665f7a0c3aefc"></a>uint8_t</td>
<td class="fieldname">
entry_id</td>
<td class="fielddoc">
ID of this entry. </td></tr>
<tr><td class="fieldtype">
<a id="a33ec60ad39db8ebf53de0a72bee466bd" name="a33ec60ad39db8ebf53de0a72bee466bd"></a>uint16_t</td>
<td class="fieldname">
game_id</td>
<td class="fielddoc">
Game ID. </td></tr>
<tr><td class="fieldtype">
<a id="a7370d297cba84f180f10bafa46cefba7" name="a7370d297cba84f180f10bafa46cefba7"></a>uint16_t</td>
<td class="fieldname">
inode</td>
<td class="fielddoc">
Inode pointer. </td></tr>
<tr><td class="fieldtype">
<a id="a2b6ef9f926b80b33797c6989ef4018e7" name="a2b6ef9f926b80b33797c6989ef4018e7"></a>char</td>
<td class="fieldname">
name[19]</td>
<td class="fielddoc">
Name of this entry. <p >The complete list of valid ASCII characters in a note name is:</p>
<pre>
ABCDEFGHIJKLMNOPQRSTUVWXYZ!"#`*+,-./:=?@
</pre><p >The space character is also allowed. Any other character will be converted to a space before writing to the mempak. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a738a028e4829b69dedb17ae6a8375c79" name="a738a028e4829b69dedb17ae6a8375c79"></a>uint8_t</td>
<td class="fieldname">
region</td>
<td class="fielddoc">
Intended region. </td></tr>
<tr><td class="fieldtype">
<a id="ac6f84c97a7f4614d2a89463baa8874be" name="ac6f84c97a7f4614d2a89463baa8874be"></a>uint8_t</td>
<td class="fieldname">
valid</td>
<td class="fielddoc">
Validity of this entry. </td></tr>
<tr><td class="fieldtype">
<a id="a4e65c83bc81eb966642da54ae8c885f5" name="a4e65c83bc81eb966642da54ae8c885f5"></a>uint32_t</td>
<td class="fieldname">
vendor</td>
<td class="fielddoc">
Vendor ID. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa56a78fe3d1d2b9427afe8d5894156df" name="gaa56a78fe3d1d2b9427afe8d5894156df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa56a78fe3d1d2b9427afe8d5894156df">&#9670;&nbsp;</a></span>delete_mempak_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int delete_mempak_entry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a mempak entry and associated data. </p>
<p >Given a valid mempak entry fetched by <a class="el" href="group__mempak.html#gaaa54d6b5cea4be11738f951318ebc758" title="Read an entry on a mempak.">get_mempak_entry</a>, removes the entry and frees all associated blocks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to delete the note from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">entry</td><td>The entry structure that is to be deleted from the mempak</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the entry was deleted successfully </td></tr>
    <tr><td class="paramname">-1</td><td>if the entry was invalid </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak was bad or not present </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga14df2d1b0aeb7436cabd95294eb29b9f" name="ga14df2d1b0aeb7436cabd95294eb29b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14df2d1b0aeb7436cabd95294eb29b9f">&#9670;&nbsp;</a></span>format_mempak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int format_mempak </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format a mempak. </p>
<p >Formats a mempak. Should only be done to wipe a mempak or to initialize the filesystem in case of a blank or corrupt mempak.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to format the mempak on</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the mempak was formatted successfully </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak was not present or couldn't be formatted </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaa54d6b5cea4be11738f951318ebc758" name="gaaa54d6b5cea4be11738f951318ebc758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa54d6b5cea4be11738f951318ebc758">&#9670;&nbsp;</a></span>get_mempak_entry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_mempak_entry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *&#160;</td>
          <td class="paramname"><em>entry_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read an entry on a mempak. </p>
<p >Given an entry index (0-15), return the entry as found on the mempak. If the entry is blank or invalid, the valid flag is cleared.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) from which the entry should be read </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">entry</td><td>The entry index (0-15) to read </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">entry_data</td><td>Structure containing information on the entry</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the entry was read successfully </td></tr>
    <tr><td class="paramname">-1</td><td>if the entry is out of bounds or entry_data is null </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak is bad or not present </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga5b092c36dbd886af01b0c4be86554946" name="ga5b092c36dbd886af01b0c4be86554946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5b092c36dbd886af01b0c4be86554946">&#9670;&nbsp;</a></span>get_mempak_free_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_mempak_free_space </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the number of free blocks on a mempak. </p>
<p >Note that a block is identical in size to a sector. To calculate the number of bytes free, multiply the return of this function by <a class="el" href="group__mempak.html#ga8291313350e93f54e8c397f6d13f9454" title="Size in bytes of a Mempak block.">MEMPAK_BLOCK_SIZE</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to read the free space from</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of blocks free on the memory card or a negative number on failure </dd></dl>

</div>
</div>
<a id="ga7e07b0ab92a7f383b355f5ed99c5f727" name="ga7e07b0ab92a7f383b355f5ed99c5f727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7e07b0ab92a7f383b355f5ed99c5f727">&#9670;&nbsp;</a></span>read_mempak_entry_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_mempak_entry_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the data associated with an entry on a mempak. </p>
<p >Given a valid mempak entry fetched by get_mempak_entry, retrieves the contents of the entry. The calling function must ensure that enough room is available in the passed in buffer for the entire entry. The entry structure itself contains the number of blocks used to store the data which can be multiplied by <a class="el" href="group__mempak.html#ga8291313350e93f54e8c397f6d13f9454" title="Size in bytes of a Mempak block.">MEMPAK_BLOCK_SIZE</a> to calculate the size of the buffer needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to read the entry data from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">entry</td><td>The entry structure associated with the data to be read. An entry structure can be fetched based on index using <a class="el" href="group__mempak.html#gaaa54d6b5cea4be11738f951318ebc758" title="Read an entry on a mempak.">get_mempak_entry</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>The data associated with an entry</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the entry was successfully read </td></tr>
    <tr><td class="paramname">-1</td><td>if input parameters were out of bounds or the entry was corrupted somehow </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak was not present or bad </td></tr>
    <tr><td class="paramname">-3</td><td>if the data couldn't be read </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga3811bed7584fee9426fa21cb77c6d669" name="ga3811bed7584fee9426fa21cb77c6d669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3811bed7584fee9426fa21cb77c6d669">&#9670;&nbsp;</a></span>read_mempak_sector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_mempak_sector </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>sector_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a sector from a mempak. </p>
<p >This will read a sector from a mempak. Sectors on mempaks are always 256 bytes in size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to read a sector from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sector</td><td>The sector (0-127) to read from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sector_data</td><td>Buffer to place 256 read bytes of data</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if reading was successful </td></tr>
    <tr><td class="paramname">-1</td><td>if the sector was out of bounds or sector_data was null </td></tr>
    <tr><td class="paramname">-2</td><td>if there was an error reading part of a sector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaf245021aed55de7a17cf417d41cdc32f" name="gaf245021aed55de7a17cf417d41cdc32f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf245021aed55de7a17cf417d41cdc32f">&#9670;&nbsp;</a></span>validate_mempak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validate_mempak </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return whether a mempak is valid. </p>
<p >This function will return whether the mempak in a particular controller is formatted and valid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to validate</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the mempak is valid and ready to be used </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak is not present or couldn't be read </td></tr>
    <tr><td class="paramname">-3</td><td>if the mempak is bad or unformatted </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga520a9d2a4eb81c7f40ed2fcc9ecafecc" name="ga520a9d2a4eb81c7f40ed2fcc9ecafecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga520a9d2a4eb81c7f40ed2fcc9ecafecc">&#9670;&nbsp;</a></span>write_mempak_entry_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_mempak_entry_data </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__mempak.html#structentry__structure__t">entry_structure_t</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write associated data to a mempak entry. </p>
<p >Given a mempak entry structure with a valid region, name and block count, writes the entry and associated data to the mempak. This function will not overwrite any existing user data. To update an existing entry, use <a class="el" href="group__mempak.html#gaa56a78fe3d1d2b9427afe8d5894156df" title="Delete a mempak entry and associated data.">delete_mempak_entry</a> followed by <a class="el" href="group__mempak.html#ga520a9d2a4eb81c7f40ed2fcc9ecafecc" title="Write associated data to a mempak entry.">write_mempak_entry_data</a> with the same entry structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to write the entry and data to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">entry</td><td>The entry structure containing a region, name and block count </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>The associated data to write to to the created entry</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the entry was created and written successfully </td></tr>
    <tr><td class="paramname">-1</td><td>if the parameters were invalid or the note has no length </td></tr>
    <tr><td class="paramname">-2</td><td>if the mempak wasn't present or was bad </td></tr>
    <tr><td class="paramname">-3</td><td>if there was an error writing to the mempak </td></tr>
    <tr><td class="paramname">-4</td><td>if there wasn't enough space to store the note </td></tr>
    <tr><td class="paramname">-5</td><td>if there is no room in the TOC to add a new entry </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gacb6424e211071cbb4fa7990fca01b96c" name="gacb6424e211071cbb4fa7990fca01b96c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacb6424e211071cbb4fa7990fca01b96c">&#9670;&nbsp;</a></span>write_mempak_sector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_mempak_sector </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>sector_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a sector to a mempak. </p>
<p >This will write a sector to a mempak. Sectors on mempaks are always 256 bytes in size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">controller</td><td>The controller (0-3) to write a sector to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sector</td><td>The sector (0-127) to write to </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sector_data</td><td>Buffer containing 256 bytes of data to write to sector</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if writing was successful </td></tr>
    <tr><td class="paramname">-1</td><td>if the sector was out of bounds or sector_data was null </td></tr>
    <tr><td class="paramname">-2</td><td>if there was an error writing part of a sector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 7 2022 08:55:10 for libdragon by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
